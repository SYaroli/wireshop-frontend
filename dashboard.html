<script src="catalog.js"></script>
<script>
  // Auth check
  if (!localStorage.getItem('userRole')) {
    alert('Access denied.');
    window.location.href = 'index.html';
  }

  // Show admin link if admin
  if (localStorage.getItem('userRole') === 'admin') {
    document.getElementById('adminLink').style.display = 'block';
  }

  // Populate part dropdown
  const partSelect = document.getElementById('partSelect');
  catalog.forEach(item => {
    const option = document.createElement('option');
    option.value = item.partNumber;
    option.textContent = `${item.partNumber} - ${item.name}`;
    partSelect.appendChild(option);
  });

  // Logout button fix
  const logoutBtn = document.getElementById('logoutBtn');
  if (logoutBtn) {
    logoutBtn.addEventListener('click', function() {
      localStorage.clear();
      window.location.href = 'index.html';
    });
  } else {
    console.error('Logout button not found - check HTML ID');
  }

  // Submit log button (basic test: alert data)
  const submitLogBtn = document.getElementById('submitLogBtn');
  if (submitLogBtn) {
    submitLogBtn.addEventListener('click', function() {
      const part = document.getElementById('partSelect').value;
      const action = document.getElementById('actionSelect').value;
      const notes = document.getElementById('notesInput').value;
      const timestamp = new Date().toISOString();

      if (!part || !action) {
        alert('Please select part and action.');
        return;
      }

      // Test: Show data in alert (later send to backend)
      alert(`Logged: Part ${part}, Action: ${action}, Notes: ${notes}, Time: ${timestamp}`);

      // Optional: Add to local history table for testing
      const logTableBody = document.querySelector('#logTable tbody');
      const row = document.createElement('tr');
      row.innerHTML = `<td>${part}</td><td>${action}</td><td>${timestamp}</td><td>${notes}</td><td>0 min</td>`;
      logTableBody.appendChild(row);
    });
  } else {
    console.error('Submit button not found - check HTML ID');
  }
</script>
